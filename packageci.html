<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Example workflow to set up continuous integration for packages | Github actions with R</title>
  <meta name="description" content="An introduction to using github actions with R." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Example workflow to set up continuous integration for packages | Github actions with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to using github actions with R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Example workflow to set up continuous integration for packages | Github actions with R" />
  
  <meta name="twitter:description" content="An introduction to using github actions with R." />
  

<meta name="author" content="Chris Brown, Murray Cadzow, Paula A Martinez, Rhydwyn McGuire, David Neuzerling, David Wilkinson, Saras Windecker" />


<meta name="date" content="2019-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="understanding-yaml.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Github Actions with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-are-github-actions"><i class="fa fa-check"></i><b>1.1</b> What are GitHub Actions?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#usethis-wrappers"><i class="fa fa-check"></i><b>1.1.1</b> Usethis Wrappers</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#marketplace-actions"><i class="fa fa-check"></i><b>1.1.2</b> Marketplace Actions</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#extensions"><i class="fa fa-check"></i><b>1.2</b> Extensions</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#more-information-and-useful-links"><i class="fa fa-check"></i><b>1.3</b> More information and useful links</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="packageci.html"><a href="packageci.html"><i class="fa fa-check"></i><b>2</b> Example workflow to set up continuous integration for packages</a><ul>
<li class="chapter" data-level="2.1" data-path="packageci.html"><a href="packageci.html#set-up-package"><i class="fa fa-check"></i><b>2.1</b> Set up package</a><ul>
<li class="chapter" data-level="2.1.1" data-path="packageci.html"><a href="packageci.html#new-project-github-first"><i class="fa fa-check"></i><b>2.1.1</b> New project, GitHub first</a></li>
<li class="chapter" data-level="2.1.2" data-path="packageci.html"><a href="packageci.html#existing-package-with-github"><i class="fa fa-check"></i><b>2.1.2</b> Existing package with Github</a></li>
<li class="chapter" data-level="2.1.3" data-path="packageci.html"><a href="packageci.html#add-github-links-to-description"><i class="fa fa-check"></i><b>2.1.3</b> Add Github links to DESCRIPTION</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="packageci.html"><a href="packageci.html#actions-for-continuous-integration-checks"><i class="fa fa-check"></i><b>2.2</b> Actions for continuous integration checks</a><ul>
<li class="chapter" data-level="2.2.1" data-path="packageci.html"><a href="packageci.html#ci-release-check"><i class="fa fa-check"></i><b>2.2.1</b> CI release check</a></li>
<li class="chapter" data-level="2.2.2" data-path="packageci.html"><a href="packageci.html#ci-full-check"><i class="fa fa-check"></i><b>2.2.2</b> CI full check</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="packageci.html"><a href="packageci.html#adding-secrets"><i class="fa fa-check"></i><b>2.3</b> Adding secrets</a></li>
<li class="chapter" data-level="2.4" data-path="packageci.html"><a href="packageci.html#what-next"><i class="fa fa-check"></i><b>2.4</b> What next?</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="understanding-yaml.html"><a href="understanding-yaml.html"><i class="fa fa-check"></i><b>3</b> So what’s actually going on in the yaml file?</a><ul>
<li class="chapter" data-level="3.1" data-path="understanding-yaml.html"><a href="understanding-yaml.html#r-syntax-options"><i class="fa fa-check"></i><b>3.1</b> R Syntax options</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="testing-with-renev.html"><a href="testing-with-renev.html"><i class="fa fa-check"></i><b>4</b> Testing with a reproducible environment</a></li>
<li class="chapter" data-level="5" data-path="contributions.html"><a href="contributions.html"><i class="fa fa-check"></i><b>5</b> Community contributions</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Github actions with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="packageci" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Example workflow to set up continuous integration for packages</h1>
<p>This is an example workflow to create a package and use GitHub actions to apply continuous integration (CI).
CI automatically checks and tests packages upon a <code>git push</code>.</p>
<p>Wrappers to implement some GitHub actions are included in the development version of <code>usethis</code>, which can be installed from GitHub using:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="packageci.html#cb4-1"></a><span class="co"># install.packages(&quot;devtools&quot;)</span></span>
<span id="cb4-2"><a href="packageci.html#cb4-2"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;r-lib/usethis&quot;</span>)</span></code></pre></div>
<div id="set-up-package" class="section level2">
<h2><span class="header-section-number">2.1</span> Set up package</h2>
<div id="new-project-github-first" class="section level3">
<h3><span class="header-section-number">2.1.1</span> New project, GitHub first</h3>
<p>The CI GitHub actions require a package that is set up with git and GitHub.
There are some useful instructions for setting up a new project in the <a href="https://happygitwithr.com/new-GitHub-first.html#new-GitHub-first">happygitwithr book</a>.
After setting up the repo in this way, you’ll need to add the infrastructure to turn the project into a package.
You can do so, for example, with the following command:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="packageci.html#cb5-1"></a>usethis<span class="op">::</span><span class="kw">create_package</span>(<span class="dt">path =</span> <span class="st">&quot;path_to_project&quot;</span>)</span></code></pre></div>
</div>
<div id="existing-package-with-github" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Existing package with Github</h3>
<p>Make sure that you have Git Hub set up with your package. Refer to <a href="https://happygitwithr.com/" class="uri">https://happygitwithr.com/</a> for setting up with an existing project.</p>
<ul>
<li><p><a href="https://happygitwithr.com/existing-github-first.html#existing-github-first">Existing project and package, github first</a></p></li>
<li><p><a href="https://happygitwithr.com/existing-github-last.html#existing-github-last">Existing project and package, github last</a></p></li>
</ul>
</div>
<div id="add-github-links-to-description" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Add Github links to DESCRIPTION</h3>
<p>You’ll need to point your package to where your GitHub instance is located.
The following function populates the URL and BugReports fields of a GitHub-using R package DESCRIPTION file with links to GitHub.
If your project is hosted by an enterprise GitHub server this is where you can specify that in the input arguments.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="packageci.html#cb6-1"></a>usethis<span class="op">::</span><span class="kw">use_github_links</span>()</span></code></pre></div>
<p>If a new GitHub Personal Access Token (PAT) needs to be generated, <code>usethis</code> will print some instructions to the console for you to follow.</p>
</div>
</div>
<div id="actions-for-continuous-integration-checks" class="section level2">
<h2><span class="header-section-number">2.2</span> Actions for continuous integration checks</h2>
<p>Both of the following functions create a yaml file in <code>.github/workflows/</code> that will trigger a CI check using GitHub actions.
They also print the code to copy into your readme to add a badge for CI.</p>
<div id="ci-release-check" class="section level3">
<h3><span class="header-section-number">2.2.1</span> CI release check</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="packageci.html#cb7-1"></a>usethis<span class="op">::</span><span class="kw">use_github_action_check_release</span>()</span></code></pre></div>
<p>This option is the more simplified check. It only specifies checking on Mac-OSX and on the most recent version of R.
If you are happy with these settings, no alterations to the automatically generated yaml are needed.</p>
</div>
<div id="ci-full-check" class="section level3">
<h3><span class="header-section-number">2.2.2</span> CI full check</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="packageci.html#cb8-1"></a>usethis<span class="op">::</span><span class="kw">use_github_action_check_full</span>()</span></code></pre></div>
<p>This option sets up a more comprehensive CI check.
It tests the package on Linux, Windows, as well as Mac-OSX operating systems.
It also queries dependencies, caches previous installations of them, and evaluates test coverage using codecov.
To make the file work as is, a token for codecov must be added to your secrets page.
We explain how to this below!
If you are not interested in syncing your package to codecov, this part is not necessary.</p>
</div>
</div>
<div id="adding-secrets" class="section level2">
<h2><span class="header-section-number">2.3</span> Adding secrets</h2>
<p>Now git add, commit the changes and push them to your repo and the action will run!</p>
</div>
<div id="what-next" class="section level2">
<h2><span class="header-section-number">2.4</span> What next?</h2>
<p>Read on to Chapter @ref{#understanding-yaml} to get an introduction to the contents of the yaml files.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="understanding-yaml.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
